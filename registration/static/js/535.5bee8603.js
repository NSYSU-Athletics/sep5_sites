"use strict";(self["webpackChunkregistration"]=self["webpackChunkregistration"]||[]).push([[535],{535:function(e,t,i){i.r(t),i.d(t,{default:function(){return j}});var l=i(3396),a=i(7139),n=i(9242);const d=e=>((0,l.dD)("data-v-99c337b2"),e=e(),(0,l.Cn)(),e),s={class:"mx-auto w-full p-5 sm:w-11/12 md:w-4/5 lg:w-2/3 xl:w-1/2"},r={class:"box-section"},_={class:"box-section"},o=d((()=>(0,l._)("div",{class:"title"},"隊伍報名",-1))),u=d((()=>(0,l._)("hr",null,null,-1))),v={class:"athlete-table"},g=d((()=>(0,l._)("td",null,"隊名",-1))),m={colspan:"3"},c=["value"],p=d((()=>(0,l._)("td",null,"報名組別",-1))),f=["value"],w=d((()=>(0,l._)("td",null,"報名項目",-1))),$=["value"],h={class:"text-right"},b={class:"box-section"},y=d((()=>(0,l._)("div",{class:"title"},"報名內容",-1))),A=d((()=>(0,l._)("hr",null,null,-1))),k={class:"register-table"},x=d((()=>(0,l._)("tr",null,[(0,l._)("th",null,"隊名"),(0,l._)("th",null,"組別"),(0,l._)("th",null,"項目"),(0,l._)("th")],-1))),D=["onClick"];function U(e,t,i,d,U,H){return(0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",r,[(0,l._)("div",{class:"text-xl text-gray-400 cursor-pointer",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},"回上頁")]),(0,l._)("div",_,[o,u,(0,l._)("table",v,[(0,l._)("tr",null,[g,(0,l._)("td",m,[(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.data.team_id=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.teamList,((e,t)=>((0,l.wg)(),(0,l.iD)("option",{key:t,value:e.team_id},(0,a.zw)(e.team_name),9,c)))),128))],512),[[n.bM,e.data.team_id]])])]),(0,l._)("tr",null,[p,(0,l._)("td",null,[(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.data.game_division_id=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.divisionList,((t,i)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:i},[e.groupSex(t.sex)||0==t.sex?((0,l.wg)(),(0,l.iD)("option",{key:0,value:t.game_division_id},(0,a.zw)(t.ch),9,f)):(0,l.kq)("",!0)],64)))),128))],512),[[n.bM,e.data.game_division_id]])]),w,(0,l._)("td",null,[(0,l.wy)((0,l._)("select",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.data.event_id=t)},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.paramsList,((t,i)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:i},[1==t.multiple&&t.game_division_id==e.data.game_division_id?((0,l.wg)(),(0,l.iD)("option",{key:0,value:t.event_id},(0,a.zw)(t.event_ch),9,$)):(0,l.kq)("",!0)],64)))),128))],512),[[n.bM,e.data.event_id]])])])]),(0,l._)("div",h,[(0,l._)("button",{class:"button",onClick:t[4]||(t[4]=(...t)=>e.submitAll&&e.submitAll(...t))},"新增")])]),(0,l._)("div",b,[y,A,(0,l._)("table",k,[x,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.registerList,((t,i)=>((0,l.wg)(),(0,l.iD)("tr",{key:i},[(0,l._)("td",null,(0,a.zw)(t.team_name),1),(0,l._)("td",null,(0,a.zw)(t.ch),1),(0,l._)("td",null,(0,a.zw)(t.event_ch),1),(0,l._)("td",null,[(0,l._)("button",{class:"button button-red",onClick:i=>e.remove(t)},"刪除",8,D)])])))),128))])])])}var H=i(4870),L=i(3927),C=i(678),Y=i(65),G=(0,l.aZ)({setup(){const e=new L.L,t=new L._,i=(0,C.yj)(),a=(0,Y.oR)(),n=(0,H.iH)({}),d=(0,H.qj)({team_id:"",game_division_id:0,event_id:""}),s=(0,H.iH)({}),r=(0,H.iH)([]),_=(0,H.iH)([]);function o(){e.Url(`games/${i.params.game_id}`).GetAll(s).then((()=>{const i=t.SportPrefix(s.value.type);e.Url(`${i}/event-params/${s.value.game_id}`).GetAll(r),e.Url(`${i}/game-division/${s.value.game_id}`).GetAll(_)}))}o();const u=(0,H.iH)([]);function v(){let t="";t=2===n.value.permission?`register/grp/team/${s.value.type}/${s.value.game_id}/${n.value.org_id}`:`register/grp/team/${s.value.type}/${s.value.game_id}/${n.value.org_id}/${n.value.dept_id}`,e.Url(t).GetAll(u).then((()=>{d.team_id=u.value[0].team_id}))}function g(){e.Url("auth/user/info").GetAll(n)}g();const m=(0,H.iH)([]);function c(){2===n.value.permission?e.Url(`register/grp/get/org/${s.value.type}/${s.value.game_id}/${n.value.org_id}`).GetAll(m):e.Url(`register/grp/get/dept/${s.value.type}/${s.value.game_id}/${n.value.dept_id}`).GetAll(m)}(0,l.YP)([s,n],(()=>{s.value.hasOwnProperty("game_id")&&n.value.hasOwnProperty("org_id")&&(v(),c())}));const p=(0,H.qj)({team_id:{filled:!1},game_division_id:{filled:!1},event_id:{filled:!1}});function f(){for(const e of Object.entries(p))for(const i of Object.entries(e[1]))if(!1===i[1])return void("filled"===i[0]?t.Alert("不得送出空報名內容"):t.Alert("請確認輸入的內容"));e.Url(`register/grp/exist/${s.value.type}/${s.value.game_id}/${d.team_id}/${d.game_division_id}/${d.event_id}`).Get().then((i=>{!0===i.message?t.Alert("該隊伍已報名過此組別項目"):e.Url(`register/grp/add/${s.value.type}/${s.value.game_id}`).Post(d).then((e=>{"done"===e.message&&(t.Alert("新增成功"),d.game_division_id=0,d.event_id="",c())}))}))}(0,l.YP)(d,(()=>{p.team_id.filled=String(d.team_id).length>0,p.game_division_id.filled=d.game_division_id>0,p.event_id.filled=d.event_id.length>0}));let w={};function $(e){t.Confirm("確定要刪除嗎？"),w=e}const h=(0,l.Fl)((()=>a.state.confirmAnswer));return(0,l.YP)(h,(i=>{"y"===i&&e.Url(`register/grp/delete/${s.value.type}/${s.value.game_id}`).Delete(`${w.team_id}/${w.game_division_id}/${w.event_id}`).then((e=>{"done"===e.message&&(t.Alert("已刪除該報名項目"),c())})),"n"===i&&t.Alert("取消刪除"),t.ResetConfirm()})),{data:d,teamList:u,divisionList:_,paramsList:r,getTeamList:v,registerList:m,groupSex:e=>{let t=!0;return u.value.forEach((i=>{i.team_id===d.team_id&&i.member_data_list.forEach((i=>{i.sex!==e&&(t=!1)}))})),t},remove:$,submitAll:f}}}),P=i(89);const z=(0,P.Z)(G,[["render",U],["__scopeId","data-v-99c337b2"]]);var j=z}}]);
//# sourceMappingURL=535.5bee8603.js.map