"use strict";(self["webpackChunkregistration"]=self["webpackChunkregistration"]||[]).push([[413],{5413:function(e,t,l){l.r(t),l.d(t,{default:function(){return ue}});var i=l(3396),d=l(9242),n=l(7139);const a=e=>((0,i.dD)("data-v-5318e196"),e=e(),(0,i.Cn)(),e),s={class:"mx-auto w-full p-5 sm:w-11/12 md:w-4/5 lg:w-2/3"},o={class:"box-section"},u={class:"box-section"},r=a((()=>(0,i._)("div",{class:"title"},"新增報名",-1))),_=a((()=>(0,i._)("hr",null,null,-1))),c={class:"athlete-table"},g=a((()=>(0,i._)("td",null,[(0,i.Uk)("是否為大專"),(0,i._)("br"),(0,i.Uk)("院校學生")],-1))),v={colspan:"3"},p=["disabled"],m=a((()=>(0,i._)("span",null,"是",-1))),h=["disabled"],b=a((()=>(0,i._)("span",null,"否",-1))),w=a((()=>(0,i._)("td",null,"所屬單位",-1))),k={colspan:"3"},y={key:0},f=a((()=>(0,i._)("div",null,"學校",-1))),U=(0,i.Uk)("找不到 "),$=(0,i.Uk)("。"),D={key:1,class:"opacity-50"},L=a((()=>(0,i._)("div",null,"系所",-1))),H={key:0},A=(0,i.Uk)("找不到 "),V=(0,i.Uk)("。 "),x={key:1,class:"opacity-50"},G={key:2,class:"opacity-50"},Y={key:1},I=a((()=>(0,i._)("div",null,"團體",-1))),z=(0,i.Uk)("找不到 "),C=(0,i.Uk)("。"),q={key:1,class:"opacity-50"},P=a((()=>(0,i._)("td",null,"選手",-1))),j={colspan:"3"},S=(0,i.Uk)("找不到 "),O=(0,i.Uk)("。"),W={key:1,class:"opacity-50"},K=a((()=>(0,i._)("td",null,"報名組別",-1))),J=["value"],M=a((()=>(0,i._)("td",null,"報名項目",-1))),N=["value"],R={class:"text-right"},Z={class:"box-section"},E=a((()=>(0,i._)("div",{class:"title"},"報名項目",-1))),F=a((()=>(0,i._)("hr",null,null,-1))),B={class:"register-table"},Q=a((()=>(0,i._)("tr",null,[(0,i._)("th",null,"姓名"),(0,i._)("th",null,"組別"),(0,i._)("th",null,"項目"),(0,i._)("th")],-1))),T=["onClick"];function X(e,t,l,a,X,ee){const te=(0,i.up)("v-select");return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("div",o,[(0,i._)("div",{class:"text-xl text-gray-400 cursor-pointer",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},"回上頁")]),(0,i._)("div",u,[r,_,(0,i._)("table",c,[(0,i._)("tr",null,[g,(0,i._)("td",v,[(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{type:"radio",value:"1",disabled:e.lockList.student,"onUpdate:modelValue":t[1]||(t[1]=t=>e.student=t)},null,8,p),[[d.G2,e.student]]),m]),(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{type:"radio",value:"0",disabled:e.lockList.student,"onUpdate:modelValue":t[2]||(t[2]=t=>e.student=t)},null,8,h),[[d.G2,e.student]]),b])])]),(0,i._)("tr",null,[w,(0,i._)("td",k,[1==e.student?((0,i.wg)(),(0,i.iD)("div",y,[f,(0,i.Wm)(te,{class:"cursor-pointer",disabled:e.lockList.org_id,clearable:!1,options:e.univList,reduce:e=>e.univ_id,modelValue:e.orgId,"onUpdate:modelValue":t[3]||(t[3]=t=>e.orgId=t),onInput:e.resetSelect},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[U,(0,i._)("em",null,(0,n.zw)(e),1),$],64)):((0,i.wg)(),(0,i.iD)("div",D,"請輸入或選擇學校"))])),_:1},8,["disabled","options","reduce","modelValue","onInput"]),L,e.deptList.length>0?((0,i.wg)(),(0,i.iD)("div",H,[(0,i.Wm)(te,{class:"cursor-pointer",disabled:e.lockList.dept_id,clearable:!1,options:e.deptList,reduce:e=>e.dept_id,modelValue:e.deptId,"onUpdate:modelValue":t[4]||(t[4]=t=>e.deptId=t),label:"label"},{"no-options":(0,i.w5)((({search:t,searching:l})=>[l?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[A,(0,i._)("em",null,(0,n.zw)(t),1),V],64)):e.orgId.length>0?((0,i.wg)(),(0,i.iD)("div",x,"載入中")):((0,i.wg)(),(0,i.iD)("div",G,"請選擇學校"))])),_:1},8,["disabled","options","reduce","modelValue"])])):(0,i.kq)("",!0)])):(0,i.kq)("",!0),0==e.student?((0,i.wg)(),(0,i.iD)("div",Y,[I,(0,i.Wm)(te,{class:"cursor-pointer",disabled:e.lockList.org_id,clearable:!1,options:e.orgList,reduce:e=>e.org_id,modelValue:e.orgId,"onUpdate:modelValue":t[5]||(t[5]=t=>e.orgId=t),label:"name_ch_full"},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[z,(0,i._)("em",null,(0,n.zw)(e),1),C],64)):((0,i.wg)(),(0,i.iD)("div",q,"請輸入或選擇團體"))])),_:1},8,["disabled","options","reduce","modelValue"])])):(0,i.kq)("",!0)])]),(0,i._)("tr",null,[P,(0,i._)("td",j,[(0,i.Wm)(te,{class:"cursor-pointer",clearable:!1,options:e.athleteList,reduce:e=>e.athlete_id,modelValue:e.data.athlete_id,"onUpdate:modelValue":t[6]||(t[6]=t=>e.data.athlete_id=t),label:"name"},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[S,(0,i._)("em",null,(0,n.zw)(e),1),O],64)):((0,i.wg)(),(0,i.iD)("div",W,"請輸入或選擇選手"))])),_:1},8,["options","reduce","modelValue"])])]),(0,i._)("tr",null,[K,(0,i._)("td",null,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.data.game_division_id=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.divisionList,((t,l)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:l},[e.sex==t.sex||0==t.sex?((0,i.wg)(),(0,i.iD)("option",{key:0,value:t.game_division_id},(0,n.zw)(t.ch),9,J)):(0,i.kq)("",!0)],64)))),128))],512),[[d.bM,e.data.game_division_id]])]),M,(0,i._)("td",null,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.data.event_id=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.paramsList,((t,l)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:l},[0==t.multiple&&t.game_division_id==e.data.game_division_id?((0,i.wg)(),(0,i.iD)("option",{key:0,value:t.event_id},(0,n.zw)(t.event_ch),9,N)):(0,i.kq)("",!0)],64)))),128))],512),[[d.bM,e.data.event_id]])])])]),(0,i._)("div",R,[(0,i._)("button",{class:"button",onClick:t[9]||(t[9]=(...t)=>e.submitAll&&e.submitAll(...t))},"新增")])]),(0,i._)("div",Z,[E,F,(0,i._)("table",B,[Q,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.registerList,((t,l)=>((0,i.wg)(),(0,i.iD)("tr",{key:l},[(0,i._)("td",null,(0,n.zw)(t.name),1),(0,i._)("td",null,(0,n.zw)(t.ch),1),(0,i._)("td",null,(0,n.zw)(t.event_ch),1),(0,i._)("td",null,[(0,i._)("button",{class:"button button-red",onClick:l=>e.remove(t)},"刪除",8,T)])])))),128))])])])}var ee=l(4870),te=l(3927),le=l(678),ie=l(65),de=l(4226),ne=l.n(de),ae=(0,i.aZ)({setup(){const e=new te.L,t=new te._,l=(0,le.yj)(),d=(0,ie.oR)(),n=(0,ee.qj)({athlete_id:"",game_division_id:0,event_id:""}),a=(0,ee.iH)(1),s=(0,ee.iH)(0),o=(0,ee.iH)(""),u=(0,ee.iH)(""),r=(0,ee.qj)({org_id:!1,dept_id:!1,student:!1}),_=(0,ee.iH)({}),c=(0,ee.iH)([]),g=(0,ee.iH)([]);function v(){e.Url(`games/${l.params.game_id}`).GetAll(_).then((()=>{const l=t.SportPrefix(_.value.type);e.Url(`${l}/event-params/${_.value.game_id}`).GetAll(c),e.Url(`${l}/game-division/${_.value.game_id}`).GetAll(g)}))}v();const p=(0,ee.iH)([]);function m(){e.Url("organization/list").GetAll(p)}m();const h=(0,ee.iH)([]);e.Url("univ-list").GetAll(h).then((()=>{for(let e=0;e<h.value.length;e++)h.value[e].label=`${h.value[e].univ_name_ch_full} (${h.value[e].univ_name_en})`}));const b=(0,ee.iH)([]);function w(){b.value=[],e.Url(`dept-list/${o.value}`).Get().then((e=>{let t={};for(let l=0;l<e.length;l++)t=e[l],t.label=`[${e[l].college_ch}] ${e[l].dept_ch}`,b.value.push(t)}))}const k=(0,ee.iH)({});function y(){e.Url("auth/user/info").Get().then((e=>{o.value=e.org_id,u.value="U"===e.org_id.substr(0,1)?e.dept_id:"",a.value="U"===e.org_id.substr(0,1)?1:0,"U"===e.org_id.substr(0,1)&&w(),2===e.permission?(r.org_id=!0,r.student=!0,a.value="U"===e.org_id.substr(0,1)?1:0):1===e.permission?(r.student=!0,r.org_id=!0,r.dept_id=!0,a.value="U"===e.org_id.substr(0,1)?1:0):(r.org_id=!1,r.dept_id=!1),k.value=e}))}y();const f=(0,ee.iH)([]);function U(){let t="";t=2===k.value.permission?`athlete/get/org/${k.value.org_id}/second`:`athlete/get/org/${k.value.org_id}/second/${k.value.dept_id}`,e.Url(t).Get().then((e=>{const t=e.home;t.concat(e.other),f.value=t.concat(JSON.parse(JSON.stringify(e.other)))}))}const $=(0,ee.iH)([]);function D(){2===k.value.permission?e.Url(`register/ind/get/org/${_.value.type}/${_.value.game_id}/${k.value.org_id}`).GetAll($):e.Url(`register/ind/get/dept/${_.value.type}/${_.value.game_id}/${k.value.dept_id}`).GetAll($)}(0,i.YP)(k,(()=>{k.value.hasOwnProperty("org_id")&&(U(),D())})),(0,i.YP)(o,((e,t)=>{e!==t&&(b.value=[],"U"===e.substring(0,1)&&w())}));const L=(0,ee.qj)({athlete_id:{filled:!1},game_division_id:{filled:!1},event_id:{filled:!1}});function H(){for(const e of Object.entries(L))for(const l of Object.entries(e[1]))if(!1===l[1])return void("filled"===l[0]?t.Alert("不得送出空報名內容"):t.Alert("請確認輸入的內容"));e.Url(`register/ind/exist/${_.value.type}/${_.value.game_id}/${n.athlete_id}/${n.game_division_id}/${n.event_id}`).Get().then((l=>{!0===l.message?t.Alert("該選手已報名過此組別項目"):e.Url(`register/ind/add/${_.value.type}/${_.value.game_id}`).Post(n).then((e=>{"done"===e.message&&(t.Alert("新增成功"),n.athlete_id="",n.game_division_id=0,n.event_id="",D())}))}))}(0,i.YP)(n,(()=>{f.value.forEach((e=>{e.athlete_id===n.athlete_id&&(s.value=e.sex)})),L.athlete_id.filled=String(n.athlete_id).length>0,L.game_division_id.filled=n.game_division_id>0,L.event_id.filled=n.event_id.length>0}));let A={};function V(e){t.Confirm("確定要刪除嗎？"),A=e}const x=(0,i.Fl)((()=>d.state.confirmAnswer));return(0,i.YP)(x,(l=>{"y"===l&&e.Url(`register/ind/delete/${_.value.type}/${_.value.game_id}`).Delete(`${A.athlete_id}/${A.game_division_id}/${A.event_id}`).then((e=>{"done"===e.message&&(t.Alert("已刪除該報名項目"),D())})),"n"===l&&t.Alert("取消刪除"),t.ResetConfirm()})),{gameData:_,lockList:r,student:a,orgId:o,deptId:u,univList:h,deptList:b,orgList:p,divisionList:g,paramsList:c,data:n,athleteList:f,sex:s,resetSelect:()=>{n.dept_id=""},submitAll:H,registerList:$,remove:V,errorList:L}},components:{"v-select":ne()}}),se=l(89);const oe=(0,se.Z)(ae,[["render",X],["__scopeId","data-v-5318e196"]]);var ue=oe}}]);
//# sourceMappingURL=413.12782ae0.js.map