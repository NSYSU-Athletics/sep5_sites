"use strict";(self["webpackChunkregistration"]=self["webpackChunkregistration"]||[]).push([[747],{747:function(e,t,l){l.r(t),l.d(t,{default:function(){return _e}});var i=l(3396),d=l(9242),a=l(7139);const n=e=>((0,i.dD)("data-v-30650348"),e=e(),(0,i.Cn)(),e),s={class:"mx-auto w-full p-5 sm:w-11/12 md:w-4/5 lg:w-2/3"},o={class:"box-section"},r={class:"box-section"},u=n((()=>(0,i._)("div",{class:"title"},"新增報名",-1))),_=n((()=>(0,i._)("hr",null,null,-1))),c={class:"athlete-table"},g={key:0},v=n((()=>(0,i._)("td",null,[(0,i.Uk)("是否為大專"),(0,i._)("br"),(0,i.Uk)("院校學生")],-1))),p={colspan:"3"},m=["disabled"],h=n((()=>(0,i._)("span",null,"是",-1))),b=["disabled"],k=n((()=>(0,i._)("span",null,"否",-1))),w={key:1},y=n((()=>(0,i._)("td",null,"所屬單位",-1))),f={colspan:"3"},U={key:0},$=n((()=>(0,i._)("div",null,"學校",-1))),D=(0,i.Uk)("找不到 "),L=(0,i.Uk)("。"),H={key:1,class:"opacity-50"},A=n((()=>(0,i._)("div",null,"系所",-1))),V={key:0},x=(0,i.Uk)("找不到 "),G=(0,i.Uk)("。 "),Y={key:1,class:"opacity-50"},I={key:2,class:"opacity-50"},q={key:1},z=n((()=>(0,i._)("div",null,"團體",-1))),C=(0,i.Uk)("找不到 "),O=(0,i.Uk)("。"),P={key:1,class:"opacity-50"},j=n((()=>(0,i._)("td",null,"選手",-1))),S={colspan:"3"},W=(0,i.Uk)("找不到 "),K=(0,i.Uk)("。"),J={key:1,class:"opacity-50"},M=n((()=>(0,i._)("td",null,"報名組別",-1))),N=["value"],R=n((()=>(0,i._)("td",null,"報名項目",-1))),Z=["value"],E={class:"text-right"},F={class:"box-section"},B=n((()=>(0,i._)("div",{class:"title"},"報名項目",-1))),Q=n((()=>(0,i._)("hr",null,null,-1))),T={class:"register-table"},X=n((()=>(0,i._)("tr",null,[(0,i._)("th",null,"姓名"),(0,i._)("th",null,"組別"),(0,i._)("th",null,"項目"),(0,i._)("th")],-1))),ee=["onClick"];function te(e,t,l,n,te,le){const ie=(0,i.up)("v-select");return(0,i.wg)(),(0,i.iD)("div",s,[(0,i._)("div",o,[(0,i._)("div",{class:"text-xl text-gray-400 cursor-pointer",onClick:t[0]||(t[0]=t=>e.$router.go(-1))},"回上頁")]),(0,i._)("div",r,[u,_,(0,i._)("table",c,["O0000"!=e.userData.org_id?((0,i.wg)(),(0,i.iD)("tr",g,[v,(0,i._)("td",p,[(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{type:"radio",value:"1",disabled:e.lockList.student,"onUpdate:modelValue":t[1]||(t[1]=t=>e.student=t)},null,8,m),[[d.G2,e.student]]),h]),(0,i._)("label",null,[(0,i.wy)((0,i._)("input",{type:"radio",value:"0",disabled:e.lockList.student,"onUpdate:modelValue":t[2]||(t[2]=t=>e.student=t)},null,8,b),[[d.G2,e.student]]),k])])])):(0,i.kq)("",!0),"O0000"!=e.userData.org_id?((0,i.wg)(),(0,i.iD)("tr",w,[y,(0,i._)("td",f,[1==e.student?((0,i.wg)(),(0,i.iD)("div",U,[$,(0,i.Wm)(ie,{class:"cursor-pointer",disabled:e.lockList.org_id,clearable:!1,options:e.univList,reduce:e=>e.univ_id,modelValue:e.orgId,"onUpdate:modelValue":t[3]||(t[3]=t=>e.orgId=t),onInput:e.resetSelect},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[D,(0,i._)("em",null,(0,a.zw)(e),1),L],64)):((0,i.wg)(),(0,i.iD)("div",H,"請輸入或選擇學校"))])),_:1},8,["disabled","options","reduce","modelValue","onInput"]),A,e.deptList.length>0?((0,i.wg)(),(0,i.iD)("div",V,[(0,i.Wm)(ie,{class:"cursor-pointer",disabled:e.lockList.dept_id,clearable:!1,options:e.deptList,reduce:e=>e.dept_id,modelValue:e.deptId,"onUpdate:modelValue":t[4]||(t[4]=t=>e.deptId=t),label:"label"},{"no-options":(0,i.w5)((({search:t,searching:l})=>[l?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[x,(0,i._)("em",null,(0,a.zw)(t),1),G],64)):e.orgId.length>0?((0,i.wg)(),(0,i.iD)("div",Y,"載入中")):((0,i.wg)(),(0,i.iD)("div",I,"請選擇學校"))])),_:1},8,["disabled","options","reduce","modelValue"])])):(0,i.kq)("",!0)])):(0,i.kq)("",!0),0==e.student?((0,i.wg)(),(0,i.iD)("div",q,[z,(0,i.Wm)(ie,{class:"cursor-pointer",disabled:e.lockList.org_id,clearable:!1,options:e.orgList,reduce:e=>e.org_id,modelValue:e.orgId,"onUpdate:modelValue":t[5]||(t[5]=t=>e.orgId=t),label:"name_ch_full"},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[C,(0,i._)("em",null,(0,a.zw)(e),1),O],64)):((0,i.wg)(),(0,i.iD)("div",P,"請輸入或選擇團體"))])),_:1},8,["disabled","options","reduce","modelValue"])])):(0,i.kq)("",!0)])])):(0,i.kq)("",!0),(0,i._)("tr",null,[j,(0,i._)("td",S,[(0,i.Wm)(ie,{class:"cursor-pointer",clearable:!1,options:e.athleteList,reduce:e=>e.athlete_id,modelValue:e.data.athlete_id,"onUpdate:modelValue":t[6]||(t[6]=t=>e.data.athlete_id=t),label:"name"},{"no-options":(0,i.w5)((({search:e,searching:t})=>[t?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[W,(0,i._)("em",null,(0,a.zw)(e),1),K],64)):((0,i.wg)(),(0,i.iD)("div",J,"請輸入或選擇選手"))])),_:1},8,["options","reduce","modelValue"])])]),(0,i._)("tr",null,[M,(0,i._)("td",null,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[7]||(t[7]=t=>e.data.game_division_id=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.divisionList,((t,l)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:l},[e.sex==t.sex||0==t.sex?((0,i.wg)(),(0,i.iD)("option",{key:0,value:t.game_division_id},(0,a.zw)(t.ch),9,N)):(0,i.kq)("",!0)],64)))),128))],512),[[d.bM,e.data.game_division_id]])]),R,(0,i._)("td",null,[(0,i.wy)((0,i._)("select",{"onUpdate:modelValue":t[8]||(t[8]=t=>e.data.event_id=t)},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.paramsList,((t,l)=>((0,i.wg)(),(0,i.iD)(i.HY,{key:l},[0==t.multiple&&t.game_division_id==e.data.game_division_id?((0,i.wg)(),(0,i.iD)("option",{key:0,value:t.event_id},(0,a.zw)(t.event_ch),9,Z)):(0,i.kq)("",!0)],64)))),128))],512),[[d.bM,e.data.event_id]])])])]),(0,i._)("div",E,[(0,i._)("button",{class:"button",onClick:t[9]||(t[9]=(...t)=>e.submitAll&&e.submitAll(...t))},"新增")])]),(0,i._)("div",F,[B,Q,(0,i._)("table",T,[X,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.registerList,((t,l)=>((0,i.wg)(),(0,i.iD)("tr",{key:l},[(0,i._)("td",null,(0,a.zw)(t.name),1),(0,i._)("td",null,(0,a.zw)(t.ch),1),(0,i._)("td",null,(0,a.zw)(t.event_ch),1),(0,i._)("td",null,[(0,i._)("button",{class:"button button-red",onClick:l=>e.remove(t)},"刪除",8,ee)])])))),128))])])])}var le=l(4870),ie=l(3927),de=l(678),ae=l(65),ne=l(4226),se=l.n(ne),oe=(0,i.aZ)({setup(){const e=new ie.L,t=new ie._,l=(0,de.yj)(),d=(0,ae.oR)(),a=(0,le.qj)({athlete_id:"",game_division_id:0,event_id:""}),n=(0,le.iH)(1),s=(0,le.iH)(0),o=(0,le.iH)(""),r=(0,le.iH)(""),u=(0,le.qj)({org_id:!1,dept_id:!1,student:!1}),_=(0,le.iH)({}),c=(0,le.iH)([]),g=(0,le.iH)([]);function v(){e.Url(`games/${l.params.game_id}`).GetAll(_).then((()=>{const l=t.SportPrefix(_.value.type);e.Url(`${l}/event-params/${_.value.game_id}`).GetAll(c),e.Url(`${l}/game-division/${_.value.game_id}`).GetAll(g)}))}v();const p=(0,le.iH)([]);function m(){e.Url("organization/list").GetAll(p)}m();const h=(0,le.iH)([]);e.Url("univ-list").GetAll(h).then((()=>{for(let e=0;e<h.value.length;e++)h.value[e].label=`${h.value[e].univ_name_ch_full} (${h.value[e].univ_name_en})`}));const b=(0,le.iH)([]);function k(){b.value=[],e.Url(`dept-list/${o.value}`).Get().then((e=>{let t={};for(let l=0;l<e.length;l++)t=e[l],t.label=`[${e[l].college_ch}] ${e[l].dept_ch}`,b.value.push(t)}))}const w=(0,le.iH)({});function y(){e.Url("auth/user/info").Get().then((e=>{o.value=e.org_id,r.value="U"===e.org_id.substr(0,1)?e.dept_id:"",n.value="U"===e.org_id.substr(0,1)?1:0,"U"===e.org_id.substr(0,1)&&k(),2===e.permission?(u.org_id=!0,u.student=!0,n.value="U"===e.org_id.substr(0,1)?1:0):1===e.permission?(u.student=!0,u.org_id=!0,u.dept_id=!0,n.value="U"===e.org_id.substr(0,1)?1:0):(u.org_id=!1,u.dept_id=!1),w.value=e}))}y();const f=(0,le.iH)([]);function U(){let t="";t=2===w.value.permission?`athlete/get/org/${w.value.org_id}/second`:`athlete/get/org/${w.value.org_id}/second/${w.value.dept_id}`,e.Url(t).Get().then((e=>{const t=e.home;t.concat(e.other),f.value=t.concat(JSON.parse(JSON.stringify(e.other)))}))}const $=(0,le.iH)([]);function D(){2===w.value.permission?e.Url(`register/ind/get/org/${_.value.type}/${_.value.game_id}/${w.value.org_id}`).GetAll($):e.Url(`register/ind/get/dept/${_.value.type}/${_.value.game_id}/${w.value.dept_id}`).GetAll($)}(0,i.YP)(w,(()=>{w.value.hasOwnProperty("org_id")&&(U(),D())})),(0,i.YP)(o,((e,t)=>{e!==t&&(b.value=[],"U"===e.substring(0,1)&&k())}));const L=(0,le.qj)({athlete_id:{filled:!1},game_division_id:{filled:!1},event_id:{filled:!1}});function H(){for(const e of Object.entries(L))for(const l of Object.entries(e[1]))if(!1===l[1])return void("filled"===l[0]?t.Alert("不得送出空報名內容"):t.Alert("請確認輸入的內容"));e.Url(`register/ind/exist/${_.value.type}/${_.value.game_id}/${a.athlete_id}/${a.game_division_id}/${a.event_id}`).Get().then((l=>{!0===l.message?t.Alert("該選手已報名過此組別項目"):e.Url(`register/ind/add/${_.value.type}/${_.value.game_id}`).Post(a).then((e=>{"done"===e.message&&(t.Alert("新增成功"),a.athlete_id="",a.game_division_id=0,a.event_id="",D())}))}))}(0,i.YP)(a,(()=>{f.value.forEach((e=>{e.athlete_id===a.athlete_id&&(s.value=e.sex)})),L.athlete_id.filled=String(a.athlete_id).length>0,L.game_division_id.filled=a.game_division_id>0,L.event_id.filled=a.event_id.length>0}));let A={};function V(e){t.Confirm("確定要刪除嗎？"),A=e}const x=(0,i.Fl)((()=>d.state.confirmAnswer));return(0,i.YP)(x,(l=>{"y"===l&&e.Url(`register/ind/delete/${_.value.type}/${_.value.game_id}`).Delete(`${A.athlete_id}/${A.game_division_id}/${A.event_id}`).then((e=>{"done"===e.message&&(t.Alert("已刪除該報名項目"),D())})),"n"===l&&t.Alert("取消刪除"),t.ResetConfirm()})),{gameData:_,lockList:u,student:n,orgId:o,deptId:r,univList:h,deptList:b,orgList:p,divisionList:g,paramsList:c,data:a,athleteList:f,sex:s,resetSelect:()=>{a.dept_id=""},submitAll:H,registerList:$,remove:V,errorList:L,userData:w}},components:{"v-select":se()}}),re=l(89);const ue=(0,re.Z)(oe,[["render",te],["__scopeId","data-v-30650348"]]);var _e=ue}}]);
//# sourceMappingURL=747.0a67b8f0.js.map